<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>장바구니</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<h1>장바구니</h1>

<table>
  <thead>
  <tr>
    <th>상품명</th>
    <th>가격</th>
    <th>수량</th>
    <th>총 가격</th>
    <th></th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="item : ${cartItems}">
    <td th:text="${item.productName}"></td>
    <td th:text="${item.price}"></td>
    <td>
      <input type="number" th:value="${item.quantity}" th:attr="data-product-id=${item.productId}" class="quantity-input">
      <button type="button" class="update-button" th:attr="data-product-id=${item.productId}">수정</button>
    </td>
    <td th:text="${item.price * item.quantity}"></td>
    <td><button type="button" class="remove-button" th:attr="data-product-id=${item.productId}">삭제</button></td>
  </tr>
  </tbody>
</table>

<script src="jquery.min.js"></script>
<script>
  $(document).ready(function() {
    // 장바구니 수량 수정 버튼 클릭 이벤트 처리
    $('.update-button').click(function() {
      var productId = $(this).data('product-id');
      var quantity = $(this).siblings('.quantity-input').val();

      $.ajax({
        url: '/cart/update',
        method: 'POST',
        data: { productId: productId, quantity: quantity },
        success: function() {
          // 성공적으로 수량이 수정되었을 때의 처리
        }
      });
    });

    // 장바구니 상품 삭제 버튼 클릭 이벤트 처리
    $('.remove-button').click(function() {
      var productId = $(this).data('product-id');

      $.ajax({
        url: '/cart/remove',
        method: 'POST',
        data: { productId: productId },
        success: function() {
          // 성공적으로 상품이 삭제되었을 때의 처리
        }
      });
    });
  });
</script>
</body>
</html>
